01:28:57 <ibid> is it necessary to free something you've malloced (Foreign.Marshal.Alloc), or does the garbage collector do this for me?
05:11:39 <Segora> hi
05:12:23 <Vulpyne> Hi.
05:23:13 <Vulpyne> What's up?
06:03:49 <Heffalump> any FFI experts around?
06:06:39 <Igloo> Heff: Take a look at "Dynamic wrapper" (bottom of page 8 in the ps file I have)
06:08:39 <Igloo> Oh, that may not be useful actually
06:09:10 <Igloo> But dynamic import above it might be
06:16:05 <Heffalump> I think its dynamic wrapper that is likely to be useful
06:16:13 <Heffalump> oh, no return value.
06:16:14 <Heffalump> hmm.
06:16:22 <Heffalump> I think I need an IO a type somewhere
06:17:17 * Igloo has closed it now, but dynamic import had a FunPtr of whatever you want IIRC
06:17:43 <Heffalump> oh, so it was
06:17:55 <Heffalump> I misread the example as defining the form of it
06:40:25 <shapr> hey Igloo, you awake?
06:40:31 <Igloo> Yup
06:40:58 <Igloo> Yesterday, were you talkingabout individual pixels causing loops?
06:41:07 <shapr> hey, I hacked my Mandelbrot.hs to return a list of iterations for each point, and then flattened that list and stuffed it into a FiniteMap
06:41:24 <shapr> it looks like there's enough duplication inside the iterations to make it worth memoizing
06:41:51 <shapr> I was thinking of building an "endpoint" FM
06:41:54 * Igloo goes to look at the code - you said (z, c) pairs, right?
06:42:37 <shapr> so that each time I get a certain input pair of z,c I can look it up in the FM, and if it's there, I can just skip to the end of all the iterations
06:42:38 <Igloo> Oh, I don't have a c - do you mean (z, xy)?
06:43:02 <shapr> I cat upload my latest code if you want
06:43:14 <shapr> er "can"
06:43:14 <shapr> I'm using the Mandelbrot.hs I wrote, not Fraskell :-)
06:43:32 <shapr> I'll get the Fraskell docs and see if I can add this optimization to Fraskell
06:43:34 * Igloo thinks you only need a list of things with the same c
06:43:45 <shapr> hm, that would require TH :-/
06:43:57 <shapr> too much to download via modem :-/
06:44:01 <Igloo> Sounds good - can you either put it on the web or e-mail me it?
06:44:10 <shapr> why same c?
06:44:18 <Igloo> Is c == xy?
06:44:23 <shapr> each iteration takes z and c as input, right?
06:44:36 <Igloo> What is c?
06:44:54 <shapr> you get the first C from x,y and Z is zero
06:45:07 <shapr> er... hmm
06:45:07 * shapr thinks
06:45:43 <Igloo> Right, so c never changes for a given pixel
06:45:56 * Igloo alters do_mb to take a list and will see what difference it will make
06:47:14 <shapr> my latest code takes just a few seconds to output an FM for 80x80 pixels, but runs out of memory with 256x256 pixels.. large FMs suck
06:47:33 <Igloo> OK, running now
06:48:36 <shapr> I wish there were a better way to build really large FMs
06:49:13 <Heffalump> they shouldn't use more than linear amounts of RAM
06:49:50 <Igloo> But that's quadratic in square side length
06:50:43 <shapr> my full iteration list could be as large as resolution * resolution * max iterations
06:51:12 <Heffalump> igloo: 9 x a few seconds shouldn't be enough time to fill memory, should it?
06:52:49 <Igloo> Oh bother, I'll have to alter my unroll code if I want to se what affect this has on the TH code too
06:54:31 <shapr> Heffalump: what's the fastest way to build FMs from large lists?
06:54:47 <Heffalump> listToFM I imagine...
06:55:16 <shapr> hm, I wonder what that does with duplicate keys...
06:55:54 <Heffalump> overwrites the earlier one with the later one
06:55:57 <shapr> oh
06:56:03 <shapr> I need a count of duplicate keys
06:56:24 <shapr> actually, that was just for checking whether memoization of endpoints would be useful
06:56:39 <shapr> I wonder if I could treat this as graph reduction
07:00:43 <Igloo> OK, using just a list is about 19% slower
07:01:00 <Igloo> A FM would be better, but probably not by much
07:01:05 <Igloo> I suspect it's just not common enough
07:01:30 <Igloo> Code I used at http://urchin.earth.li/~ian/Mandelbrot.lhs
07:02:32 <Igloo> OTOH, with TH I could try doing the test just once halfway through. I shouldn't play now, though.
07:02:51 <Heffalump> why not?
07:04:27 <ibid> is it necessary to free something you've malloced (Foreign.Marshal.Alloc), or does the garbage collector do this for me?
07:04:32 <Igloo> Because I should be reading a paper (or possibly writing YA talk)
07:04:39 <Heffalump> ah
07:04:44 <Heffalump> YA? You've only done 1 so far...
07:05:04 <Igloo> And now I have to do *another*!
07:05:55 <shapr> what's just not common enough?
07:06:02 <Igloo> Looping points
07:06:17 <Igloo> Do you have any numbers handy?
07:07:16 <shapr> I have an fmToList of "filter (> 1) elts allItersFM"
07:08:05 <shapr> (((6.87257371931069e-2,0.5088446848842187),(1.063161558748246,-3.106313179996202)),99)
07:08:18 <shapr> that says that z,c gets called 99 times
07:08:28 <Igloo> Huh?
07:08:54 <Igloo> Have you changed the way i is modified?
07:09:11 <Igloo> If not it could only be about 25 at most
07:09:20 <Igloo> Unless I'm really confused
07:09:33 <shapr> huh?
07:09:46 <Igloo> Can I see the code?
07:09:50 <shapr> I might be terribly confused.. I'll mail you the source...
07:09:56 <Igloo> Ta
07:10:02 <Igloo> (igloo@earth.li)
07:22:16 <shapr> Igloo: does that explain what I'm talking about?
07:22:59 <shapr> it's memoization across points
07:23:23 <Igloo> Oh, I *see*. I thought you were looking at Mandelbrot.lhs from Fraskell
07:23:26 <Igloo> (it does compile without TH, it just doesn't have the unrolling performed)
07:23:32 <Igloo> (for the benefit of the channel)
07:23:42 * Igloo goes to work out what's happening
07:23:48 <shapr> if I create an FM of z,c to maxIter or out-of-bounds, then I can just look up the end result if it's already in the FM
07:24:13 <shapr> I dunno if that's really more efficient, since iterating can probably stay in the cache, but FM lookups are a larger hit
07:24:21 <shapr> depends on how similar the iteration paths are I guess
07:24:32 <shapr> do you think this is worth pursuing?
07:24:46 <Igloo> Right, so what you are doing is repeatedly applying "oneIter (MandelData (iterNum, z, c)) = (MandelData (iterNum + 1, z*z+c, c))", right?
07:24:55 <Igloo> And looking up (z, c) in the FM?
07:25:03 <shapr> that's the idea at least
07:25:15 <Igloo> And c = x + y*i?
07:25:18 <Heffalump> so just memoising each iteration?
07:25:26 <shapr> I haven't done that yet... so far I've only saved a list of all (z,c)and build an FM to see if there are duplicates
07:25:45 <shapr> there are many duplicates, even in an 80x80 @ 256 maxiters
07:25:51 <Igloo> So the points (3+4i) and (4+5i) will never look at the same values in the FM?
07:25:59 <shapr> huh?
07:26:04 <Igloo> So you only need to remember values for the current point
07:26:12 <Igloo> huh to what?
07:26:15 <Heffalump> I think he's remembering values everywhere.
07:26:22 <shapr> hm
07:26:24 <Heffalump> TICBconfused
07:26:50 <shapr> yah, currently I'm remember values for every point....
07:27:03 <shapr> maybe my code is broken.. C should be different for every point, right?
07:27:08 <shapr> why did I find so many duplicates?
07:27:11 * shapr is confused
07:27:11 <Igloo> I think you are doing, but I don't think you need to
07:27:27 <Igloo> Well, (0, (0, 0)) will give you 200 duplicates
07:28:13 <Heffalump> memoising is bound to save some effort, since all those that don't go immediately out of bounds will go next to another point you want to look at
07:28:16 <Igloo> But my experiment with Fraskell makes me think that that sort of thing is sufficiently rare that the checking will take longer than the time saved by not applying iter in a few cases
07:28:31 <Igloo> WDYM, Heff?
07:28:44 <Heffalump> oh, no.
07:28:54 <Igloo> You could memoise z^2, actually
07:29:10 <shapr> that's true
07:29:10 <Heffalump> the lookup would be more expensive than the operation
07:29:29 <shapr> but from what I see now, z^2 is the only thing you could memoise
07:29:37 <Igloo> True, and it would take a reasonable amount of space
07:30:43 <shapr> oh well
07:31:53 <shapr> I can't think of another way to optimize these calculations
07:32:12 <Heffalump> igloo: making programs monadic sounds like it'd be cool, btw
07:32:12 * shapr thinks about value interpolation
07:32:30 <Heffalump> if you could interpolate Mandelbrot it wouldn't be a fractal
07:33:04 <shapr> is there a way to do a derivative on this?
07:33:27 <Marvin--> Heffalump: :)
07:33:30 <Igloo> Heff: I think I'd need a slightly better explanation of what the intention was and/or an example
07:33:43 <shapr> maybe then you could find regions where it's all the same?
07:33:45 <shapr> that would probably also be too expensive...
07:33:46 <shapr> hmmm
07:34:27 <Igloo> I've happened across messages from the fractint list (I think) which give the impression you can do whizzy things, but I didn't try to understand them (not even sure if detail was given)
07:34:47 <shapr> how did you find those msgs?
07:34:55 <shapr> any keywords?
07:37:14 <Igloo> http://home.san.rr.com/jayrhill/iFAQ/Deep_Zooming_Feigenbaum_point.txt
07:37:38 <Igloo> Oh,not actually sure if that is the Mandelbrot set or not
07:51:30 <shapr> I wish an MPI or PVM version of xfractint existed.
07:52:31 <Marvin--> yay *got a ride for the roleplaying session*
07:53:16 * Igloo would quite like to know why my C port of Fraskell is 7.5 times faster than the TH unrolled version
07:53:28 <shapr> hm, I think I've only read two books of Martin's GoT
07:53:43 <Heffalump> cos laziness is expensive?
07:53:48 <Heffalump> try some strictness annotations
07:54:08 <shapr> maybe you need some strictness in the right spots?
07:54:11 <Igloo> I'm not sure where I'd put them
07:54:17 <Heffalump> on all the arithmetic
07:54:58 <Igloo> The only arithmetic left should be strictly evaluated anyway I think
07:55:06 <Heffalump> because GHC is clever?
07:55:37 <Igloo> Think so
07:55:40 <Igloo> I could try it
07:56:19 <Igloo> z^2 + xy => (+) $! ((^) $! z $! 2) $! xy, right?
07:56:36 <Igloo> Or did you mean something else?
07:57:00 <Heffalump> that's what I meant, yes
08:12:52 <Igloo> I have more brackets than a LISP programmer and a type error
08:13:42 <Heffalump> you have more type errors than a LISP programmer too, then
08:13:57 <Igloo> Aha, but only in the unrolled version
08:19:36 <Heffalump> igloo: here's a concrete example of what I'd like to be able to do automatically: translate map into mapM given only the changes in type
08:19:40 <Heffalump> signature
08:21:06 <Igloo> Hmmmm, OK
08:22:26 <Heffalump> problem is that it requires you to chase types throughout
08:22:27 * Igloo will think about that some time
08:22:31 <Igloo> Yeah
08:24:34 <Heffalump> the other problem is that there are two correct answers
08:25:23 <Igloo> One being return []?
08:25:38 <Heffalump> apart from that, I think it's actually quite easy
08:25:54 * Igloo was thinking of a DWIM sort of thing, but there could easily be cases where that just wouldn't work
08:25:59 <Heffalump> no, the two correct answers being the order you get the values in the recursive case
08:26:07 <Igloo> Ah, I see
08:26:13 <Heffalump> b <- f a ; bs <- mapM f as
08:26:17 <Heffalump> or the other way around
08:39:23 <Heffalump> 'lo
08:39:36 <hdaume> mornin'
08:39:43 <Heffalump> igloo: you should call your new machine haskell.comlab, or templatehaskell.comlab :-)
08:41:15 <Igloo> :-)
08:41:26 <Igloo> It needs to appear first  :-(
08:41:55 <Heffalump> it should soon, apparently
08:42:10 <Igloo> I could try asking for join-hash-haskell-on-irc-freenode-net.comlab
10:03:32 * Igloo wonders if the M iteratino can ever loop without (x, y) being one of the points on the loop
10:28:51 <dark> Greetings
10:32:38 <hdaume> hi dark
11:06:15 <Heffalump> 'lo
11:20:29 * Heffalump points all those interested in the Haskell Report copyright at section 1.2.2 of the HC&A report
11:24:58 <dark> Could you point more accurately please? :)
11:25:27 <Heffalump> you want a URL too?
11:27:13 <ibid> what's HC&A?
11:27:16 <dark> Either that or an expansion of "HC&A report".
11:28:10 <Heffalump> http://www.haskell.org/communities/11-2002/html/report.html
11:30:03 <ibid> sounds like there's nothing one can do anymore about it
11:30:19 <ibid> the GNU FDL would have been a good choice to consider
11:32:20 <Heffalump> I think he should have opened up the vote he took at the HW to the mailing list
11:32:33 <Heffalump> I suspect there might have been a rather different result
11:32:57 <ibid> indeed
11:33:57 <hdaume> Heffalump: what do you think the result would have been?
11:34:08 <ibid> (and of course, i only sporadically read the lists... i would have missed it most likely anyway)
11:34:27 <dark> I note that modifications aren't even discussed.
11:35:08 <ibid> i think it was me who convinced them to do an explicit copyright back then... i was actively putting out the debian packaging and it was a problem
11:35:18 <ibid> explicit license
11:35:19 <ibid> rather
11:37:39 <dark> I can't find the license for the Haskell Report on haskell.org, though.
11:38:06 <hdaume> look in the ps/pdf versions
11:38:08 <dark> I remember ghc not having an explicit license, way back when.
11:38:11 <hdaume> i think
11:39:25 <dark> I think that having a free standard for a language is *way* more important than printing it out more efficiently.
11:40:00 <Heffalump> hdaume: I suspect it'd have been more in favour of keeping the report free at any cost, though how much so I don't know
11:40:35 <Heffalump> dark: but there were only 7 people at the HW who thought that
11:40:47 <dark> Heffalump: Yes, that surprised me.
11:41:26 <Heffalump> dark: the problem is that the HW is biased towards academics, predictably enough
11:41:42 <Heffalump> so I guess in some senses it's fair enough, since Haskell is almost entirely written by academics
11:42:26 <Heffalump> but I don't think the phrase "but there were enough people present to be reasonably representative" is accurate
11:43:01 <hdaume> hrm....i don't *think* i care, but i don't think i know enough to know why it matters...i get the impression you fall into the (C) category...mind explaining why?
11:43:46 <Heffalump> well, first of all, the new licence would be non-free, so Debian couldn't package it any more (well, they'd move it to the non-free section, which is probably not /too/ bad)
11:43:47 <ibid> was the HW held in the USA?
11:43:51 <Heffalump> ibid: Pittsburgh
11:44:11 <ibid> ok, that will also skew. there are people who will not enter the usa for any reason
11:44:26 <Heffalump> hdaume: secondly, "commercial use" would preclude it being distributed on distro CDs that are sold
11:44:38 <ibid> i'd imagine this sentiment is fairly common among non-usan academics
11:44:40 <Igloo> Licences, docs and Debian aren't as clear cut as that
11:44:50 <Heffalump> igloo: oh, ok
11:44:59 <dark> hdaume: I could, with a gedankenexperiment.  Suppose, five years from now, a group gathers enough energy to define Haskell 2, and it is good.  Obviously large parts of its definition will be derived from Haskell98.  Now they want to publish their new standard... oops.
11:45:08 * Igloo doesn't know details as I tend to ignore legal debates, though
11:45:22 <Heffalump> dark: I made that precise point, but the consensus (which I don't agree with) was that it wouldn't affect Haskell 2
11:45:33 * Igloo will have a look shortly and probably post to the list expressing my disappointment
11:45:38 <ibid> Igloo: actually, it is that clear cut
11:45:40 <dark> Heffalump: Did they achieve consensus on a neater value of pi at the same time? :)
11:45:48 <Heffalump> dark: :-)
11:45:51 <ibid> Igloo: if i understood right as to what you referred to
11:46:07 <Heffalump> dark: the argument was that they could just change the wording of things and it'd be ok
11:46:23 <hdaume> Heffalump: but it only affects works related to the definition, not to the actual language, right?
11:46:27 <ibid> Heffalump: they'd have to come up with an independent wording
11:46:27 <Igloo> Actually, it might be WRT non-commercialness. But I think that at least you don't have to give modification rights
11:46:29 <Heffalump> hdaume: correct
11:46:34 <ibid> Heffalump: a complete rewrite
11:46:34 <dark> I also think it's just way too high a price to pay.  A single publication of it in book form, in exchange for the right to *ever* do it with another publisher.
11:46:51 <ibid> Igloo: for what?
11:47:00 <ibid> Igloo: modification rights are essential for debian main
11:47:04 <dark> Also, consider that for example a book documenting GHC itself might want to quote extensively from the Report.  Again, oops.
11:47:05 <Heffalump> although they need to fix the licence to allow implementers to use code fragments from the report (which SPJ said he'd make sure was done, but hasn't mentioned in his entry AFAICS)
11:47:24 <hdaume> i think i still stand in the "i don't care" camp ;), so long as Heffalump's most recent comment is done
11:47:26 <Heffalump> ibid: even for documentation, as opposed to code?
11:47:46 <dark> (The gcc docs have exactly this problem with the C standard)
11:48:20 <ibid> Heffalump: there are two camps on that, but inclusive side is winning (at least considering actual practice)
11:48:32 <Heffalump> Robert Ennals pointed out that standards which have gone closed have typically led to incomplete implementations in the part (e.g. C++)
11:48:36 <dark> Heffalump: For technical documentation, which might have to be changed to reflect changes in code, definitely.
11:48:45 <Heffalump> right.
11:49:05 <dark> Heffalump: I think that considering the number of technical corrections to this new Haskell 98, it would be impossible to say with a straight face that such technical changes won't be needed :)
11:49:10 <ibid> inclusive meaning, also documentation requires mod rights
11:49:11 <Heffalump> :-)
11:50:01 * Igloo fails to find the threads I'm thinking of easily and gives up
11:50:18 <Heffalump> how many people here atm are Debian developers? Igloo, ibid and dark?
11:50:27 * ibid is, true :-)
11:50:48 <Heffalump> I knew you three were, just looking for others hiding in the woodwork :-)
11:51:06 <ibid> i seem to recall seeing Marvin-- in #debian-devel
11:52:22 <ibid> my stance: if there is a book, i'll buy a copy, but i'd rather there wasn't if it means making the specs nonfree
11:52:26 <dark> Marvin is in the queue :)
11:53:04 <Heffalump> ibid: likewise
11:53:28 <ibid> btw, is anybody here willing to take over haskell-doc? also the editorial upstream?
11:53:28 <dark> I find it hard to argue for something I find self-evident :)
11:54:04 <dark> I've seen delYsid around here and #debian-devel.
11:54:15 <Heffalump> ibid: what needs doing (I'm not a developer though)
11:54:17 <Heffalump> ?
11:54:20 <Igloo> editorial upstream?
11:54:21 <dark> liiwi is also a Debian person.
11:54:29 <dark> And shapr has had lunch with liiwi :-)
11:54:31 <ibid> Igloo: the collection editorship
11:54:41 <ibid> shapr is a debian person but not a dd
11:55:21 * Igloo might be willing to
11:56:00 <ibid> Heffalump: for editorial upstream, making it better, updating the documents, fixing the outstanding bug; for debian packaging: i think it's getting a little bitrotty
11:56:32 * ibid has had several offers but none have actually done anything about it
11:56:35 <Heffalump> if Igloo doesn't do it, would I be able to without being a dd?
11:56:50 <ibid> Heffalump: you'll need a sponsor
11:56:56 <ibid> (i don't sponsor)
11:57:08 <Heffalump> in other words I'd have to become one?
11:57:18 <ibid> Heffalump: even handling the upstream only would be helpful
11:57:41 <ibid> Heffalump: eventually. but sponsorship is a way to do real work without being one
11:57:59 <Heffalump> well, I'd probably maintain both a foo.spec file and the debian/ directory in the upstream
11:58:28 <ibid> in that case it'd be beneficial if you'd get a sponsor and enter the queue
11:58:28 <Igloo> We could do it together
11:58:33 <ibid> true
11:58:37 <Igloo> Then we could hav elong pointless arguments about where commas should go
11:58:43 <ibid> i could act as the inactive backup :-)
11:58:45 <Heffalump> that sounds like a good plan.
11:58:54 * hdaume is off to lunch
11:59:03 <Heffalump> is the report in haskell-doc?
11:59:06 <ibid> yes
11:59:08 * Igloo meant me and Heff, but ibid and all of #haskell could join in the fun  :-)
11:59:23 <ibid> Igloo: i know you meant that
11:59:53 <ibid> actually, the very first thing you guys could do is subscribe to the package in pts...
11:59:55 <Heffalump> is the latest version uploaded to the repositories?
12:00:03 <ibid> repositories?
12:00:04 <Heffalump> pts?
12:00:07 <Heffalump> IM Debian
12:00:27 <ibid> yes, i think so
12:00:35 <ibid> http://packages.qa.debian.org/h/haskell-doc.html
12:00:41 <Heffalump> as in if I do apt-get source haskell-doc with my sources.list set to use unstable will I get the latest version, or do you have some local changes not uploaded yet
12:01:20 <ibid> i might have, but nothing significant. i certainly can't remember having any :-)
12:01:20 * Heffalump subscribes
12:01:45 <ibid> the upstream tarball is ...
12:02:02 <Heffalump> igloo: do you feel like playing with arch for this, or shall we stick it in a CVS repository?
12:02:16 <Igloo> Oh, arch sounds like a very good idea indeed
12:02:23 <ibid> in here: ftp://ftp.jyu.fi/private/antkaij/haskell-doc/
12:02:33 * Igloo realises this might be becoming non-free, or at least split, shortly
12:02:38 <ibid> yes
12:02:52 <Igloo> Actually, what does the current license say?
12:02:54 <ibid> and i worked so hard to move it out of non-free in 1998/9...
12:02:58 <Heffalump> igloo: yeah, hence my question about the report
12:03:07 <Heffalump> igloo: we could stick with the current report and keep it in free
12:03:12 <Igloo> I just hadn't put 2 and 2 together yet  :-)
12:03:21 <Igloo> What is the current report?
12:03:27 <Heffalump> still free.
12:03:36 <Igloo> The one on haskell.org now?
12:03:45 <Heffalump> the one on the "revised report" link, yes
12:03:47 <Igloo> Not the one on research.microsoft.com/~simonpj?
12:03:58 <Igloo> Ah, hmmm
12:03:59 <Heffalump> http://research.microsoft.com/Users/simonpj/haskell98-revised/haskell98-report-html/index.html
12:04:25 * Heffalump is really unkeen on splitting the package
12:04:37 <Heffalump> cos then if we put the FFI addendum in, which we should, that'd need to go in contrib...
12:04:42 * Igloo subscribes twice, the second time with the right address. Doh.
12:04:52 <ibid> Heffalump: why?
12:05:02 <Igloo> I'm reasonably unlikely to do anything for a week, BTW, but should hopefully do something then
12:05:09 <Heffalump> cos it'd depend on something in non-free, surely?
12:05:32 <Heffalump> the FFI addendum without the report would be pointless
12:05:45 <Heffalump> but the FFI addendum itself would remain free
12:05:50 <ibid> Heffalump: not really pointless
12:05:51 <Igloo> OK, so what do CUP actually get from the copyright?
12:06:07 <Heffalump> igloo: not much, AFAICT
12:06:13 <Igloo> Oh, do they get the name Haskell 98? Or even Haskell?
12:06:19 <ibid> actually, has spj gotten an okay from all the authors for the license change?
12:06:30 <Heffalump> ibid: NAFAIK, I was wondering about that myself.
12:06:38 <Igloo> He hasn't from me, but I don't know if I have done enough for it to be relevant
12:06:40 <ibid> ok, then he can't do it
12:06:44 <Heffalump> igloo: you haven't
12:06:56 <ibid> Igloo: are you listed as one of the authors
12:07:04 <Igloo> Didn't think so - I mainly pointed out bugs rathr than suggested rewordings IIRC
12:07:04 <Heffalump> no, he's just contributed bug-fixes
12:07:06 <ibid> instead of one of the thanks...
12:07:13 <ibid> even /me is listed in the thanks
12:07:17 <Igloo> :-)
12:07:23 <ibid> i think it is for the license thing...
12:07:36 <ibid> i certainly haven't contributed anything technical
12:07:43 <Igloo> Do CUP get control of the name in any way, anyway?
12:07:54 <ibid> how could they?
12:08:00 <ibid> names cannot be copyrighted
12:08:05 <Heffalump> igloo: only in the sense of "not being able to claim modified versions are definitions of Haskell 98"
12:08:18 <ibid> and there is certainly prior use making trademarking pointless
12:08:44 <ibid> Heffalump: they can't enforce that
12:09:00 <ibid> unless someone has the haskell 98 trademark in their pocket...
12:09:01 <Heffalump> they can for modified versions of the report, since they have the copyright on it
12:09:25 <ibid> Heffalump: well, yes. but that does not extend to complete rewrites
12:09:32 * Igloo can't see why the report would need to be moved to non-free anyway
12:10:01 <ibid> Igloo: if its license is changed to not conform to dfsg
12:10:13 <Igloo> But we have a copy under a free license
12:10:28 <ibid> Igloo: yes. but how good does it do to have an obsolete version?
12:10:39 <Heffalump> it won't be obsolete, though
12:10:45 <ibid> oh?
12:10:47 <Heffalump> cos we have a copy of the version from just before it goes to CUP
12:10:50 <Igloo> All we have to do is ask people to give us the changes under a free license
12:10:51 <ibid> ahh yes
12:10:58 <ibid> hehe :-)
12:11:00 <Igloo> s/the/new/
12:11:02 <Heffalump> the current CVS version is still free.
12:11:07 <ibid> a free fork
12:11:14 <Heffalump> but...
12:11:21 <Heffalump> we can't get people's changes and still claim to be Haskell 98.
12:11:39 <ibid> somebody should probably make a note about the other authors' consent
12:11:41 <Heffalump> even if they're the same changes that go into the CUP book
12:11:47 <Igloo> We can be Free Haskell 98, though
12:11:48 <ibid> Heffalump: what's stopping you?
12:11:54 <Heffalump> ibid: copyright law...
12:12:05 <ibid> Heffalump: you cannot copyright book titles
12:12:08 <Igloo> Or Haskell 2002
12:12:15 <Heffalump> >> The authors intend this Report to belong to the
12:12:15 <Heffalump> >> entire Haskell community, and so we grant permission
12:12:15 <Heffalump> >> to copy and distribute it for any purpose, provided
12:12:15 <Heffalump> >> that it is reproduced in its entirety, including
12:12:15 <Heffalump> >> this Notice. Modified versions of this Report may
12:12:17 <Heffalump> >> also be copied and distributed for any purpose,
12:12:19 <Heffalump> >> provided that the modified version is clearly
12:12:22 <Heffalump> >> presented as such, and that it does not claim to be
12:12:24 <Heffalump> >> a definition of the language Haskell 98.
12:12:28 <ibid> ahh, true
12:12:31 <Heffalump> so, we can take the current version, and we can distribute that under the DFSG (I assume)
12:12:33 <Igloo> ibid: It would be bad form to claim to be H 98 even if we are legally allowed to
12:12:35 <ibid> the existing license
12:12:47 <ibid> Igloo: not if it is textually the same
12:12:52 <ibid> Heffalump: yes
12:13:02 <ibid> ok, call it Haskell 2002 :-)
12:13:04 <ibid> fork it
12:13:12 <Heffalump> but if we get people's changes, *even if they are the same changes that go into the "official" version*, we can't claim to be Haskell 98 any more.
12:13:17 <ibid> Haskell for the Free World
12:13:25 <Heffalump> so the second the licence changes, we have to freeze or go non-free.
12:13:32 <ibid> ... or change name
12:13:40 <Heffalump> I'm strongly opposed to that.
12:13:49 <Heffalump> though I agree it's an option
12:14:02 <ibid> better to have a different name and same content than same name and different content
12:14:07 <ibid> imho
12:14:14 <ibid> much better actually
12:14:42 * Igloo does some wgetting of http://research.microsoft.com/Users/simonpj/haskell98-revised/ before going to get a CVS snapshot
12:15:02 <Heffalump> the CVS snapshot has the copyright notice inside it, I just checked
12:15:11 <Heffalump> where are we going to keep this, urchin?
12:15:25 <ibid> nongnu.org?
12:15:26 <Igloo> What is "this"? The arch repository?
12:15:44 <ibid> nongnu only supports cvs though
12:15:48 <ibid> currently
12:15:49 <Heffalump> igloo: yes
12:16:08 <Igloo> Is arch a tree or a graph of repositories, OOI?
12:16:10 <Heffalump> ibid: we have access to many net connected machines that one or the other of us has root on, so it's easier to host ourselves
12:16:31 <Igloo> urchin sounds fine
12:16:46 <ibid> Heffalump: true
12:17:24 <ibid> are you two in the same area?
12:17:40 <Heffalump> ibid: yeah, we used to live in the same house and all :-)
12:17:47 <Heffalump> and we work in the same research group now
12:18:02 <ibid> ok
12:18:21 <ibid> makes even more sense then
12:18:25 <Heffalump> yeah
12:18:31 <Heffalump> and we like arguing over commas.
12:18:44 <ibid> as long as you remember offsite copies ... but wait, i didn't do them either:-)
12:18:51 <Heffalump> urchin is offsite
12:19:08 <Heffalump> and its CVS repository gets rsynced to back here nightly
12:19:16 <ibid> if urchin is the main system then it's not offsite
12:19:20 <Heffalump> oh, but if we use arch I need to add that to the rsync list
12:19:33 <Igloo> Euch, CVS read locks. Wouldn't happen in a real source control system, I tell you!
12:19:50 <ibid> cvs does not need locks
12:19:58 <Heffalump> well, our checkouts will be to here, so even if the repository went phut we'd have latest checked out versions somewhere
12:20:05 <ibid> only wimps use cvs locks
12:20:19 * Heffalump is a wimp with a default configuration
12:20:25 <ibid> Heffalump: it's better to have whole repo somewhere
12:20:26 <Igloo> Heff: You have a CVS snapshot, right?
12:20:29 <Heffalump> ibid: sure
12:20:35 <Heffalump> igloo: no, I was just reading it on the web
12:20:42 <Heffalump> I didn't do a proper checkout
12:20:44 <ibid> Heffalump: cvs default config does not use locks
12:20:57 <Heffalump> ibid: it does everywhere I've used/installed it...
12:20:59 <ibid> (except to synchronise repo changes)
12:21:13 <ibid> you are doing something strange
12:21:34 <Heffalump> I'm fairly sure a cvs diff | less in one window can prevent me doing anything with cvs in another window.
12:21:38 <Igloo> Does anyone object to me sending a message to the list saying something to the effect of "OK, CUP can have their copyright, but we still get to keep a copy of $URL under the licence on the front of it and to release updates as 'Free Haskell 98'"?
12:22:01 <Heffalump> igloo: are you intending to say that or ask that?
12:22:08 <ibid> Heffalump: not if you scroll the less buffer to the end first... to consume all the cvs diff
12:22:16 <Heffalump> ibid: sure, but I don't always do that
12:22:26 <Igloo> ibid: Otherwise I suspect it wouldn't be clever enough to give you a consistent view
12:22:37 <Heffalump> I was just pointing out that this can cause it to hold a read lock which stops me doing anything.
12:22:38 <ibid> Heffalump: and i suspect it doesn't do it even then...
12:22:49 <ibid> Igloo: 22:20 < ibid> (except to synchronise repo changes)
12:22:59 <Igloo> Heff: Ermmm, not sure. Probably say it with an "AIUI" at the front
12:23:00 * ibid tests
12:23:08 <Heffalump> igloo: up to you.
12:23:16 <hdaume> AIUI = ?
12:23:18 <Heffalump> if you want to claim to speak for me as well then send me a copy first
12:23:21 <hdaume> nm
12:23:23 <Heffalump> As I understand it
12:23:29 <Heffalump> but right now I have to go home for dinner.
12:23:30 * Heffalump does so
12:23:40 <Igloo> I don't plan on claiming to speak for anyone else
12:24:09 <ibid> i can easily get a second cvs diff on the same file while a cvs diff | less is running untouched
12:24:38 <ibid> just tested
12:24:43 <Igloo> Well, it's possible it was waiting while someone was writing, but it seems unlikely to me
12:24:48 <ibid> (debian unstable on the client, nongnu.org as the server)
12:24:49 <Igloo> Oh, and the user was cvs, so doubly so
12:25:26 <ibid> Igloo: hm, sometimes there is a server-side fuckup that makes the synch lock dangle on too long. that's a server-side problem.
12:25:41 <ibid> Igloo: cc me?
12:26:19 <Igloo> Well, it'll go to the list anyway, but I will if you want. I'll probably eat first, though.
12:26:34 <ibid> cc me anyway, i'm not going to look at the lists soon anyway
12:26:40 <ibid> and i'm going to bed...
12:26:47 <Igloo> OK  :-)
12:27:25 <ibid> do you know what's irritating
12:28:08 <ibid> writing something in haskell and notice it takes 45 seconds and 130 mb's to run the code... and then writing the equivalent in c and notice it's instataneous and requires no extra memory
12:28:30 * ibid is now accessing the c version using ffi, but it is sooooo inelegant
12:28:40 <Igloo> :-(
12:29:02 * Igloo needs to fix my TH stuff and see how close to C's speed I can get my code
12:29:35 <ibid> but anyway, mail me when you people are ready to upload a new version to debian
12:29:57 <ibid> and oh, go and ita the rfa bug
12:32:18 <ibid> bed, bbl
12:32:33 <ibid> (btw, i prefer ajk@debian.org for haskell-doc mails)
12:32:36 <ibid> bbl
12:39:13 <Igloo> Well that's what I was going to use as I don't have any other  :-)
12:44:29 <Igloo> Hmmm, the modified versions clause doesn't seem to require that the licence is kept the same
12:48:38 * Heffalump reappears
12:49:31 <Heffalump> igloo: no, so you can make it stricter
12:49:37 <Heffalump> but you can't make it looser
12:50:35 <Igloo> Really?
12:51:03 <Heffalump> well, you can license your modifications more loosely
12:51:08 <Igloo> Is that made clear by copyright law then?
12:51:39 <Heffalump> errm, I haven't read copyright law, but that's my understanding of it, yes
12:51:58 <Heffalump> the point is that the copyright and therefore the license of the original still apply to any modified versions
12:52:50 <Igloo> Any comments on http://urchin.earth.li/~ian/mail.txt before I send it?
12:53:07 <Igloo> Hmmm, I guess that makes sense
12:54:00 <Heffalump> s/it's/its/
12:54:15 <Igloo> Thanks  :-)
12:54:21 <Heffalump> something is fucked with the line breaking
12:54:32 <Igloo> HDYM?
12:54:41 <Heffalump> and the last sentence of the first para makes no sense, I think you've missed somethin gout
12:54:50 <Igloo> It's the obvious greedy algorithm for 72 char lines
12:55:04 <Igloo> Ooops, yes
12:55:24 <Heffalump> the line starting "the current licence" ends with "publishing", then there's some spaces, and "it under this..."
12:56:23 <Igloo> Ermmm, I think copy and paste failed me
12:59:24 * Igloo decides to think about it a bit more before sending
14:27:38 <Heffalump> 'lo
14:29:53 <Pseudonym> G'day.
14:45:39 <Igloo> Damn, my earlier problems seem to be in GHC, not my code
15:03:03 <Heffalump> 'lo
15:04:01 <Heffalump> does the FFI addendum count as a derivative of the H98 report, under copyright law?
15:05:40 <Igloo> I very much doubt it
15:06:19 <Heffalump> well, it doesn't mean much without it
15:06:32 * Heffalump isn't sure
15:06:59 * Marvin-- notes that the haskell tab is blue
15:07:14 <Heffalump> you were mentioned as a debian developer in training earlier
15:07:18 <Heffalump> that's all, I think
15:07:18 <Marvin--> oh, right
15:07:40 <Marvin--> it seems like I didn't manage to convince michaelw to stay though
15:08:30 <andersca> hey Marvin--
15:09:15 <Marvin--> evening
15:09:24 * Marvin-- came home from a pretty good D&D3 session
15:44:55 <Chilli> Heffalump: 'lo - the FFI adddendum definitely is *not* a derivative of the H98 report
15:45:36 <Chilli> absolutely nothing has been copied from H98
15:46:16 <Heffalump> chilli: but it still means nothing without H98
15:46:55 <Heffalump> I'm not really clear on how copyright law defines derivative works - for example, a script that altered the source code of some project would almost certainly be counted as a derived work
15:47:41 <Heffalump> even if the script didn't have anything from the actual source code in it
15:48:04 <Heffalump> (if it didn't, the GPL would be meaningless)
15:48:05 <Chilli> copyright is about presentation
15:48:10 <Heffalump> s/didn't/didn't count as such/
15:48:36 <Chilli> so, you effectively need to copy parts of the original to make something a derivative
15:49:02 <Chilli> However, H98 and the FFI Addendum are orthogonal texts
15:49:25 <Chilli> logically, they belong together, but from a copyright perspective, they are entirely separate
15:50:05 <Chilli> even the LaTeX code used to set the grammar (although, the result looks like in the original report) was developed from scratch
15:50:30 <Chilli> eg, if you write a book
15:50:38 <Chilli> and I write a parody on that book
15:50:45 <Heffalump> parodies are specifically exempt, though
15:50:51 <Chilli> imitating the style and structure, my book still is *not* a derivative
15:50:57 <Heffalump> imitation works aren't exempt, for example
15:51:27 <Heffalump> parody is a specifically and explicitly defined instance of fair use
15:51:50 <Chilli> under which countries law :-)
15:52:01 <Chilli> (copyright law is pretty diverse)
15:52:21 <Heffalump> it tends to have the same basic principles, though
15:52:44 <Heffalump> AFAIK, fair use, parody etc apply in UK, US, AU (although differently weakened in UK/US by recent laws)
15:52:50 <Chilli> but the case of the FFI addendum is clear under at least central European and US-ish laws
15:52:51 <Heffalump> >> [A] “derivative work” is a work based upon one or
15:52:51 <Heffalump> >> more preexisting works, such as a translation,
15:52:51 <Heffalump> >> musical arrangement, dramatization,
15:52:51 <Heffalump> >> fictionalization, motion picture version, sound
15:52:51 <Heffalump> >> recording, art reproduction, abridgment,
15:52:53 <Heffalump> >> condensation, or any other form in which a work may
15:52:55 <Heffalump> >> be recast, transformed, or adapted. A work
15:52:58 <Heffalump> >> consisting of editorial revisions, annotations,
15:53:00 <Heffalump> >> elaborations, or other modifications, which, as a
15:53:03 <Heffalump> >> whole, represent an original work of authorship, is
15:53:05 <Heffalump> >> a “derivative work”.
15:53:22 <Heffalump> I'm still not convinced that it's not at least possible that the FFI falls under that definition
15:53:36 <Heffalump> e.g. "elaborations"
15:53:59 <Chilli> definitely not
15:54:54 <Heffalump> hmm :-)
15:55:47 <Pseudonym> Think of it like a patent.
15:55:57 <Chilli> because the FFI doesn't re-state anything from H98
15:55:57 <Chilli> it doesn't summarise or so H98
15:55:57 <Chilli> there is no overlap of the two
15:56:18 <Pseudonym> If I patent a mechanism for exercising a cat by pointing a laser pointer at a wall and jiggling it, it isn't a "derivative" of any patents on laser pointers, or on cats.
15:56:40 <Heffalump> Pseudonym: patent law and copyright law are different, though
15:56:55 <Pseudonym> In this case I think they're analogous.
15:56:57 <Heffalump> the linux kernel copyright extends to things that use the kernel's "non-public" interface, e.g. modules
15:57:29 <Heffalump> you two could very well be right, btw, in fact I think it's more likely than not that you are - it's just I'm nowhere near 100% certain of this
15:58:15 <Heffalump> analagously to the kernel situation, the FFI extends H98 in a way that actually mucks with the internals in some ways
16:01:55 <Heffalump> oh well
16:02:09 * Heffalump goes to bed and sticks looking for more evidence one way or the other on his todo list
16:03:01 * Igloo hmmms
16:17:51 <dark> Heffalump: Do you think that a Haskell program that relies on GHC extentions is a derivative work of GHC?
16:18:08 <Heffalump> no, but one that extended GHC itself would be
16:18:51 <dark> In any case, copyright specifically applies to expressions of ideas, not the ideas themselves.
16:19:50 <Chilli> dark: exactly
16:20:10 <dark> The FSF's reasoning about the GPL applying to programs dynamically linked to GPL'd libraries is based on the notion that by distributing a program that won't run without the library, you are in fact distributing the linked result in some meta-way, thus either engaging in "conspiracy to infringe" or infringing directly, depending on who you ask.
16:20:29 <dark> I don't think that distributing the FFI addendum can in any way be construed as distributing the Haskell98 report :)
16:20:52 <dark> (In case you didn't notice, I'm not terribly impressed by the FSF's reasoning here :)
16:21:42 <Heffalump> dark: it's not that you're distributing the report, it's that the FFI addendum is a derivative work. In the same way as a diff (without the - lines) would be counted as one.
16:21:53 <Pseudonym> In particular, it doesn't apply (IMO) to the case where the program _will_ run without the dynamically linked library.
16:21:55 <Pseudonym> Say, if it's a plug-in/
16:22:36 <Pseudonym> I consider the FFI addendum to be a kind of plug-in.
16:22:59 <Heffalump> but is that the view a court would take?
16:23:07 <dark> Pseudonym: That's the wrong way around.
16:23:08 <Chilli> Heffalump: under copyright law, a derivative work, is a work that is a modification of the original work
16:23:19 <Chilli> Heffalump: FFI is in no way a modification of H98
16:23:28 <dark> There are no guarantees about what view a court would take, either way.  You might get an stupid judge :)
16:23:36 <Heffalump> it isn't? People will talk about H98, or H98+FFI
16:23:54 <dark> I'm fairly sure you could apply the FFI addendum to other Haskell standards if you wanted.
16:24:02 <dark> Or even to other, similar languages.
16:24:17 <dark> Java would benefit immensely from it, for example :-)
16:24:24 <Heffalump> it specifically states it's an addendum to H98, though, doesn't it?
16:25:37 <Chilli> Aha, now I see how you get this idea
16:25:48 <Chilli> H98+FFI is a derivative of H98
16:26:07 <Chilli> but the FFI spec is not a derivative of the H98 spec
16:26:19 <Heffalump> because...?
16:26:22 <Chilli> the copyright applies only to the spec not to the FFI itself
16:26:35 <Heffalump> hmm.
16:26:36 <Chilli> the spec and the described thing are not the same
16:26:44 <Heffalump> that makes sense
16:26:51 <Chilli> under copyright law, it is only the spec that is protected in any way
16:27:04 <Chilli> anything else would require a patent
16:27:17 <Heffalump> one could still take the view that the only use of the FFI spec was in conjunction with the H98 spec, though
16:27:28 <Chilli> but it doesn;t matter
16:27:43 <Pseudonym> Yes, because you're dealing with use of the spec.
16:27:47 <dark> Note that Sun tries to do more with its Java specs, though.
16:27:49 <Pseudonym> i.e. making an implementation from the spec
16:27:50 <Chilli> because the copyright applies only to the spec in the sense of a book
16:28:12 <dark> I think it's important to make a distinction between traditional, sane copyright laws, and current, insane copyright law interpretations.
16:28:33 <Heffalump> dark: well, the latter are what matter atm, legally
16:29:31 <dark> For example, TSR had the opinion that lists of spells designed to work in AD&D settings were infringing on their copyrights, and managed to get a lot of those removed from the net.
16:29:39 <Igloo> Chilli: Where do you stand on the H98 report licensing issue OOI?
16:29:47 <Chilli> Heffalump: copyright of H98 spec does not protect H98, it only protects the written exposition
16:30:13 <Heffalump> chilli: hmm, ok, I'm somewhat but not completely convinced by that
16:30:33 <Chilli> Igloo: difficult thing - at the H98 I voted for at least electronic distribution rights must be free
16:30:58 <Chilli> Igloo: but if I had to decide it, I would say it must be completely free
16:30:58 <Heffalump> (would that be enough for DFSG, btw?
16:30:58 <Heffalump> )
16:31:04 <Chilli> Heffalump: no
16:31:17 <Chilli> that's why I don't like it
16:31:41 <Igloo> The GNU FDL isn't DFSG fre according to something I came across earlier (which rings a bell - I think it allows immutable bits of documentation)
16:31:54 <Chilli> DFSG: doesn't accept anything that has any restrictions, no compromises
16:32:02 <dark> Chilli: I think it's a bad bargain.  It would mean giving up some rights for the next 70 years (or whatever it'll be 70 years from now...) in return for more efficient printouts for the next two or three years.
16:32:12 <Pseudonym> Chilli: I think there's a case for disallowing modifications.
16:32:32 <Pseudonym> While retaining free distribution.
16:32:41 <Chilli> Pseudonym: there is a case for diasllowing modifications without changing the name
16:32:47 <Pseudonym> True.
16:33:00 <Pseudonym> So if someone wants to create an Objective Haskell spec, for example.
16:33:05 <Chilli> dark: I agree, but having the text in print would still be an advantage
16:33:07 <dark> Igloo: Yes, many hundreds of mails have been expended over the issue of invariant texts in the GFDL :)
16:33:26 <dark> It also fails my "License must not be more than 200 lines long" test...
16:33:40 <Igloo> :-)
16:33:46 <clausen> yeah, it's way too complicated :/
16:34:15 <dark> Chilli: Hmm, what about those book-at-a-time shops?  I'm sure we could provide them with the kind of source material they need.
16:34:36 <dark> The ones where you go in and they print a book for you.
16:35:24 <Chilli> dark: yes, but being able to order it at B&N makes the distribution more convenient
16:35:46 <Chilli> I really hope SPJ manages to get CUP to agree to make it free
16:36:05 <Chilli> if so, I'll buy a copy to show my support :-)
16:36:13 <Heffalump> in fact, what's to stop someone taking the version just before it gets CUPed, and sending it to said book-at-a-time shop?
16:36:32 <Chilli> Heffalump: yep, that's one of these good questions...
16:36:39 * Heffalump will probably buy a copy whatever the final copyright is, but I won't be happy about it if it's not free
16:37:25 <Igloo> CUP probably have a share of the copyright on the PS drafts
16:37:39 * clausen is clausen@gnu.org for a reason, hehe
16:37:43 <Heffalump> well, CUP are going to fix the line lengths and things first
16:38:02 <Heffalump> so those'd have to be fixed by whoever sent it to said shop
16:38:16 <Heffalump> and there'd be the issue of whether it could be called Haskell 98 or not, after said modifications
16:39:25 * Igloo doesn't care if it says "Haskell 98" or "The people's Haskell 98" on the cover
16:39:35 <Igloo> So CUP haven't had anything to do with the editting thus far then?
16:39:44 <Heffalump> nafaik
16:39:50 * Igloo can't remember what the copyright notice on it says OTTOMH
16:40:04 <Heffalump> well, sorry
16:40:16 <Heffalump> there's the "integrated" version on the web page, which has the new copyright notice
16:40:24 <Heffalump> but CVS still has all the stuff with the old notice
16:42:01 <dark> The new copyright notice has been settled already?
16:42:08 <dark> Or is this a different new notice?
16:42:25 <Heffalump> the new notice is in the book version on SPJ's page
16:42:34 <Heffalump> the old one is still on the HTML etc versions there
16:43:01 * Igloo starts to write a new mail, sighs and thinks it might just be easier to just start a fork should any more changes be made after it is published if the final licence isn't free
16:43:26 <dark> Igloo: I know that sense of despair :)
16:43:47 <dark> Anyway, I'll buy a copy iff the license stays free.
16:44:24 <Igloo> The thing is I'm not in a good situation to be getting on the wrong side of SPJ ATM  :-(
16:45:26 <Igloo> And thinking about what he wrote I'm not sure it'll make a difference unless we can sure a clear, strong preference for freeness
16:45:40 <dark> s/sure/show/?
16:46:01 <Igloo> If someone started a, what do you call the things people put their name on?, I'd put my name on it though  :-)
16:46:04 <Igloo> petition, that's the one
16:46:20 <Igloo> s/sure/show/2
16:46:42 <Igloo> s/preference/majority/ really, too
16:47:00 <Heffalump> if I was going to raise this on the mailing list, I'd argue for him to extend the HW vote to the entire list, and see what happens
16:47:09 <Heffalump> that way at least it'd be a representative opinion
16:47:19 <Heffalump> s/be/really &/
16:47:31 <Pseudonym> No it wouldn't.  Someone would stack the vote.
16:47:36 <Pseudonym> Probably me, actually.
16:47:46 <Heffalump> how?
16:48:02 <Heffalump> you'd need multiple very different addresses to do so
16:48:04 <Pseudonym> Getting ring-ins who don't care about Haskell but do care about free specs to join and vote.
16:48:10 <Heffalump> ah.
16:48:22 <Heffalump> how about only allowing people who've ever posted to the list to vote?
16:48:43 <Heffalump> i.e. before the discussion starts
16:49:21 <Igloo> You have to do more than just get a majority for freeness, though - you have to get a sufficiently large number of people that it will not be published if CUP don't agree to freeness
16:49:43 <Igloo> And I don't think numbers are likely to make a huge amount of difference to CUP's decision
16:49:46 <hdaume> i think you should get a # of votes proportional to how many times you've posted.  i will then charge people to sway my vote ;)
16:50:27 <Heffalump> well, since he said that he would proceed with it unfree on the basis of there being a majority of the HW happy with that, logically he should unproceed if there was a majority of the mailing list not happy with that
16:50:49 <hdaume> Heffalump: that sort of depends on what *his* vote is, though
16:51:00 <hdaume> Heffalump: i will almost always go along with the majority as long as it agrees with me
16:51:08 <Heffalump> this is true
16:51:20 * Igloo wonders if I can subtly, or otherwise, bring it up on Wednesday
16:51:24 <Heffalump> but you might be being unfair to suggest that he'd behave that way
16:51:45 <dark> What I find ironic is the statement that CUP would lose money on this printing.  Apparently making it unfree is important because CUP is worried that someone else might be so eager to lose *more* money that they'd undercut it.
16:52:41 <Chilli> Igloo: I don't think it's a problem to write to SPJ what you think
16:52:51 <Pseudonym> I somehow doubt people will unsubscribe just for that edition.
16:52:56 <hdaume> Heffalump: very true
17:03:27 <Igloo> OK, any opinions on http://urchin.earth.li/~ian/mail.txt?
17:04:00 <Igloo> Pseudonym: Huh?
17:04:17 <Heffalump> from JFP
17:04:23 <Heffalump> it's going to be both a book and a special issue of that
17:04:31 <Igloo> Oh, right
17:04:57 <Pseudonym> Ah, I see.
17:05:07 <Pseudonym> It's the book they're concerned about more than the issue.
17:05:18 * Pseudonym didn't realise it would be a book too
17:09:34 * Igloo takes the silence as people generally not caring and sends  :-)
17:09:59 <dark> Igloo: My silence was reading it :)  Did you already send?
17:10:11 <Igloo> Oh, sorry  :-)
17:10:13 <Igloo> No
17:12:13 <dark> Hmm, it _is_ sad in tone, as you note at the top.  But it doesn't seem to open the issue, it sort of accepts the decision.
17:13:23 <dark> Then again, the mail might be exactly right -- present the audience with concrete consequences, instead of maybes and coulds.
17:13:55 <Igloo> You could always follow up with a different angle  :-)
17:14:07 <dark> That makes the decision "can we live with a forked standard" as opposed to "can we live with a restricted standard" :)
17:14:30 <Igloo> Right, *really sends*
17:15:31 * Igloo encourages other pro-freedom people to follow up with their views
17:16:15 <Heffalump> I will tomorrow
17:16:26 <Pseudonym> Shae!
17:16:27 <sethk> Igloo:  I just connected, what are you talking about?
17:16:39 <Igloo> sethk: See my mail to haskell@
17:16:51 <Igloo> Or http://urchin.earth.li/~ian/mail.txt if that's more convenient
17:17:07 <sethk> Igloo:  Thanks.  I'm on the ghc list but possibly not on that list?
17:17:13 <Igloo> Hey shapr
17:17:13 <shapr> hi Pseudonym!
17:17:20 <Pseudonym> How's the new life?
17:17:38 <Igloo> haskell@ and ghc-users@ are different lists, but I don't know which you are on  :-)
17:17:45 <Igloo> That URL has a copy of the mail as sent, anyway
17:17:55 <shapr> I like Boden,it's a nice place.
17:18:03 * dark has a midnight hunger attack, and notes that the secret to midnight omelettes is to drown them in garlic oil.
17:18:08 <shapr> Swedish is much easier to learn than Finnish.. all in all, things are going quite well.
17:18:17 * Igloo repeats "* -> Igloo encourages other pro-freedom people to follow up with their views" in the hope shapr is one such  :-)
17:18:21 <shapr> Monday the DSL shows up, I can barely wait...
17:18:28 <dark> shapr: I had that experience too, I picked up a reasonable amount of swedish just by accident.
17:18:38 <sethk> Igloo:  If this is part of a legal problem, then they can issue exemptions for specific groups or conditions.
17:18:44 <dark> Igloo: First I need to get off my ass and subscribe :)
17:18:58 <Igloo> Presumably Swedish is easier if you know Finnish, though...
17:19:01 <shapr> Pseudonym: thanks for submitting a #haskell ad in the communities report!
17:19:13 <shapr> I just didn't get that together what with the move and all.
17:19:13 <dark> Igloo: No, the languages are radically different.
17:19:17 <Igloo> sethk: They almost certainly will for non-commercial things - that's not the point
17:19:24 <dark> Igloo: Finnish has some loan-words from Swedish, that's about it.
17:19:28 <shapr> nah, Swedish is easier if you know German and Dutch
17:19:40 <Pseudonym> shapr: No prob.  At least my entry wasn't controversial.
17:19:40 <Igloo> One's "Hei", one's "Hej", clearly almost the same  :-)
17:19:44 <sethk> Igloo:  Do you know what provoked this?
17:19:46 <shapr> the closest relative Finnish has is estonian, and the next closest is Hungarian
17:19:48 <Igloo> (unless I'm wrong, anyway)
17:20:04 <dark> Igloo: Yeah but I don't think Swedish has "moi moi" :)
17:20:09 <shapr> Igloo: pro-freedom for what?
17:20:12 * Igloo realises I haven't got as far as reading the #haskell bit yet
17:20:22 <Igloo> Oh, and my compile finished when I wasn't looking!
17:20:33 <Igloo> shapr: Haskell 98 report
17:20:34 <dark> Hmm, speaking of Haskell ads, maybe I should promote my favourite language on kuro5hin :)
17:20:37 <sethk> Igloo:  You should not look more often
17:20:46 <Igloo> Hmmm, I should have put the URL in the message. Oh well.
17:20:59 <shapr> oh, you mean pro-freedom for the H98 report?
17:21:12 <Igloo> Yup
17:21:33 <Igloo> sethk  :-)
17:21:47 <shapr> I'm fine with the CUPS having copyright of the published content, as long as the original online report is GPL'ed or something close.
17:22:12 <shapr> does Template Haskell subsume DrIFT or Strafunski?
17:22:13 <Pseudonym> That seems to be the consensus here.  I promise not to steal CUP's typography.
17:22:15 <Igloo> It's likely to be no commercial distribution at best
17:22:32 <Igloo> Which probably means no debian/main
17:22:39 <Igloo> No idea
17:22:41 <Pseudonym> shapr: No.  Strafunski is quite different.
17:23:04 <shapr> I would be completely against the online version being infected by CUPS copyright
17:23:08 <sethk> Pseudonym:  Is there a URL on that?  I'm wavering on template haskell
17:23:26 <shapr> to the point of forking it from just before the copyright version
17:23:27 <Pseudonym> sethk: Read the report. :-)
17:23:43 <shapr> http://research.microsoft.com/~simonpj/papers/meta-haskell
17:23:58 <dark> shapr: The potential fork is already ready :)
17:24:15 <shapr> dark: yay :-)
17:24:18 <sethk> penudonym, shapr:  I meant on the thing that is different than template haskell
17:24:20 <Igloo> I already have 3 names for it - just need to choose one  :-)
17:24:29 <shapr> can someone explain the mdo stuff to me?
17:24:38 <Igloo> Oh, and we need someone to find another H 98 bug  :-)
17:24:41 <shapr> value recursion? is that like fractal iterations?
17:24:44 <dark> Igloo: The Popular Front of Haskell?  Popular Haskellian Front?  People's Front of Haskell?
17:24:53 <Igloo> lol
17:24:54 <Pseudonym> I thought we were the Popular Front.
17:25:22 <shapr> I wonder if the Arrow preproc should be rewritted in TH
17:25:23 <Pseudonym> sethk: No, not really.  Read the papers, you'll see they're quite different.
17:25:23 <Igloo> Oh, 4 names: "#Haskell 98"
17:25:35 <dark> Igloo: If you want to be radical, incorporate FFI into the fork :)
17:26:00 <Pseudonym> shapr: mdo is recursive do.
17:26:06 <Pseudonym> mdo x <- foo x
17:26:06 <Igloo> But then H 98 implementations wouldn't necessarily be $foo implementations
17:26:12 <shapr> hah, #Haskell 98 is good
17:26:30 <dark> Igloo: Hmm, right.  Optional parts are bad.  That's one thing I learned from WAP specs, anyway :)
17:26:48 <Igloo> IPv6 has compulsory options, which I think is quite cute
17:26:52 <sethk> Pseudonym:  I know where the template haskell paper is, but not where the papers about the other systems are
17:26:54 <dark> Heh.
17:26:58 <Igloo> Admittedly options meaning something a bit different in the context
17:27:40 <dark> Igloo: Compulsory support, optional use?
17:27:48 <shapr> ipv6 is spiffy, I like the chained header structure
17:28:17 <shapr> I'm looking forward to multicast based games, should cut down on the bandwidth needed to run a server
17:28:17 <dark> Igloo: HTTP/1.1 has that in reverse, clients have to support chunked encoding but servers don't :)
17:28:22 <Igloo> Options are blocks of n bits after the fixed header stuff. The fragment option is required to be supported.
17:29:17 <Igloo> shapr: What sort of game?
17:29:30 * Igloo can't see how it would help a quake-a-like
17:30:17 <dark> Igloo: Hmm... it would help a Diablike, if new levels could be multicast.
17:30:39 <shapr> Igloo: multiplayer online games
17:30:43 <Igloo> Aren't they very low average bandwidth anyway?
17:30:48 <dark> Igloo: on the other hand, level transitions aren't the annoying part :)
17:30:49 <Igloo> shapr: But what style?
17:31:13 <Igloo> You need to need to send the same data to multiple clients
17:31:15 <dark> (Lag from the bandwidth peaks in intense combat scenes, those are annoying and get characters killed)
17:31:24 <shapr> for first person shooters, servers are massive hogs
17:31:40 <Igloo> Yes, but you send each player different information in FPSs
17:31:50 <shapr> for counterstrike, you really need at least a T1 to have 32 players.
17:32:33 <shapr> I suspect at least some of the FPS data could be multicast
17:33:07 <Igloo> Yay, bug fixed
17:33:45 <dark> Hmm, it might be interesting to design a partly-multicast protocol, where common data is extracted and grouped at a low level, with a stream layer on top of that which makes it look like a private stream to each client.
17:33:50 <shapr> actually, I think most FPS data could be multi
17:34:19 <shapr> dark: LZW ;-)
17:34:23 <Igloo> If you have a single server then peak data is *probably* what you care about
17:34:31 <shapr> all tokes above a certain frequency get multi
17:34:38 <Pseudonym> shapr: Patent.
17:34:43 <shapr> er "tokens"
17:34:55 <dark> shapr: Then you get a sequencing problem, specifying which tokens are in which stream would take extra space :)
17:35:01 <shapr> Pseudonym: seriously? :-)
17:35:06 <dark> I think you'd need fairly large common chunks for this to work.
17:35:29 <dark> But I think fairly large common chunks are not unusual.  Hmm, take NFS for example :-)
17:35:42 <shapr> you build the data dictionary server-side...
17:35:53 <dark> On the other hand, it would be rare for multiple clients to need the same data at the same time.
17:36:01 <dark> Except in multiplayer games, that is.
17:36:12 <shapr> and you multicast both the dictionary and tokens, once those tokens get above a certain frequency
17:36:20 <dark> Pseudonym: Patent expires in 1-2 years, protocol development takes longer anyway :)
17:36:32 <Pseudonym> If the game isn't patent-free, I'm writing a letter to the mailing list.
17:36:43 <shapr> Pseudonym: you think someone already has that patented?
17:36:58 <shapr> what mailing list? :-)
17:37:06 <dark> shapr: I think it's safe to assume that any protocol or program of any significance is patented.
17:37:09 <Pseudonym> I'll create one for the purpose.
17:37:31 <Pseudonym> lunch
17:37:43 * shapr grins
17:38:05 <dark> shapr: Remember, though, the protocol will have to be light on the server.  The server is already busy running the game :)
17:38:10 <shapr> hmmmm, WASH/CGI now has HWS support
17:38:22 <shapr> HWS-WP should make Thiemann's life exciting.
17:38:55 <shapr> I suspect a compression & multicast layer should be ok
17:39:02 * Igloo gets Haskell execution time down to 63 seconds, vs about 15 for C
17:39:59 <Chilli> Igloo: where is the remaining overhead?
17:40:17 * Igloo looks confused and goes to check that's right
17:40:25 <Igloo> That's what I'd like to work out  :-)
17:40:26 <shapr> hi Chilli!
17:40:43 <Chilli> Hi shapr!
17:41:00 <Chilli> Igloo: well, -ddump-simpl is your friend
17:41:35 <Igloo> Oh, that reminds me, do you (or anyone else) know what @ means in -ddump-something?
17:41:41 <Igloo> (either simpl or spec I think)
17:41:45 <shapr> wow, when did Buddha show up?
17:42:05 <Chilli> @ is a type application
17:42:31 <Chilli> eg
17:42:34 <Igloo> So it is $ for types?
17:42:41 <Chilli> yes
17:42:57 <Igloo> OK, ta
17:43:16 <Chilli> there are two types of abstractions and two type of applications: one each for types and one each for values
17:43:59 <Chilli> Igloo: try to remove all case scrutinizing boxed values out of your inner loops
17:44:29 <Chilli> that usually has a dramatic impact on performance
17:45:15 <Igloo> /\ being type abstraction, right?
17:45:15 <Igloo> I think that was in the docs but I think types were applied like normal functions
17:45:16 <Igloo> Eeep, 10 seconds for the C
17:45:45 <Chilli> yes, /\ is type abstraction
17:47:19 <Igloo> I assume the #s in GHC.Prim.>## mean that is unboxed?
17:47:50 <Igloo> Ah, addition of complex numbers has no #s
17:48:27 <Chilli> yep, # indicates unboxed prims (by convention)
17:48:41 * Igloo tries with the real Complex library
17:49:10 <Chilli> it may be that nobody every bothered to optimise complex numbers for performance
17:50:23 <Igloo> I'd made a copy with half teh methods removed so I could have Complex Rational, but the time difference looks like just noise
17:54:50 <Igloo> From what you say it looks like the complex numbers are my problem though (http://urchin.earth.li/~ian/simpl if you want to take a look at -ddump-simpl output)
17:58:22 <shapr> aha.. buddha, debugger for GHC : http://www.cs.mu.oz.au/~bjpop/code.html
17:59:16 <Igloo> Space invaders - another for the Haskell games collection?
18:00:14 <Chilli> Igloo: *urgh* can't you dump the Core generated from the TH template?
18:00:19 <shapr> yah, I think so
18:00:46 <Chilli> Igloo: the THSyntax representation in Core is even worse to read than Core itself
18:01:07 <Igloo> Chilli: Yes, but that would have had different optimisations performed
18:01:32 * Chilli is confused
18:01:45 <Chilli> if you run that template, it'll generate some Haskell code, right?
18:01:55 <Igloo> Oh, I misread that
18:02:01 <Chilli> now, if you dump the Core representation of that Haskell code
18:02:19 <Chilli> otherwise, you won't know what GHC does to the Haskell you generate anyway
18:03:48 <Igloo> This is that core though, isn't it? It's the output of rm Mandelbrot.o; ghc -O2 -cpp -fglasgow-exts -package haskell-src -Wall --make Fraskell -o Fraskell -DTEMPLATE_HASKELL -ddump-simpl
18:04:30 <Igloo> Oh, starting from the "==================== Tidy Core ====================" line
18:04:52 <Chilli> but do_mb_d4Q0 :: [GHC.Base.Char]
18:05:02 <Chilli> this is a String!
18:05:22 <Igloo> That's before that line, though
18:05:33 <Chilli> ah, maybe
18:05:38 <Chilli> what is the main loop?
18:05:44 <Chilli> (ie, which variable)
18:06:20 <Igloo> The inner loop has been unrolled, so do_mb is just called for each point xy
18:07:41 <Chilli> do_mb does not occur in the Tidy Core
18:08:07 <Igloo> No, I was trying to work out where it started. It's all been inlined
18:08:55 <Chilli> what is Mandelbrot.T for a type?
18:09:20 <Igloo> I think it starts around "case ^1 x lvl30 of tpl2 { GHC.Float.D# a3 ->" (line 664)
18:09:23 <Igloo> T = Double
18:09:31 <Igloo> C = complex T
18:10:34 * Igloo puts the code at http://urchin.earth.li/~ian/strict.Mandelbrot.lhs
18:10:35 <Chilli> hmm, one problem is surely the result type being a list of lists
18:10:46 <shapr> hey, I bet buddha and QuickCheck would be fast friends.
18:10:51 <Chilli> and for go1 being a list
18:11:14 <Igloo> Hmmm, I don't see what I can do about that
18:11:22 <Chilli> arrays :-)
18:11:36 <Igloo> But then it wouldn't be constant space
18:12:05 <Chilli> to points:
18:12:12 <Chilli> (1) is the C version constant space?
18:12:16 <Igloo> Yes
18:12:23 <Chilli> (2) What happens to the list of lists afterwards
18:12:25 <Igloo> Compute pixel. Write pixel. Repeat.
18:12:47 <Chilli> so, the C version is deforested
18:13:32 <Igloo> Oh, actually, for PPM files a single list would do
18:13:39 <Chilli> you will need to deforest the Haskell version, too, I guess
18:13:45 <Igloo> ppm_body = concatMap (\(r, g, b) -> [chr r, chr g, chr b]) . concat      gets applied to the list of lists
18:14:05 <Chilli> where does the C version write the pixels to?
18:14:37 <Igloo> It just does write(fd, x, 3);
18:15:04 <Igloo> Haskell is doing writeFile on ppm_body (give or take a header)
18:17:00 <Chilli> hmm, do you know how much of the running time is due to writeFile?
18:17:30 <Igloo> I'm just profiling the non-THed version now (for some reason it's almost as fast when strict airthmetic is used)
18:19:24 <Igloo> Doh!
18:19:30 * Igloo tries that again with optimisation on
18:19:49 <Chilli> :-)
18:22:27 <Igloo> 93.3 of the time was in do_mb
18:22:48 <Igloo> 3.4% in ppm_body
18:22:53 * Igloo tries with a single list
18:27:03 <Chilli> I don't think that single versus nested list will make much of a difference (unless it enables secondary optims)
18:27:14 <Chilli> if you look at the case cascades
18:27:38 <Chilli> you see how all this boxing and unboxing of Complex.:+ and Float# happens all over the place
18:27:55 <Chilli> I'd try to get rid of that
18:28:30 <shapr> be back tomorra
18:28:34 <Igloo> You're right, only 1 second difference
18:28:39 <Igloo> Night shapr
18:29:14 <Igloo> Hmmm, I could bring back Complexish and try strictness annotations there
18:29:37 <Igloo> Oh, except it already has them
18:31:42 <Chilli> it's not about strictness
18:32:04 <Chilli> there are strange things going on
18:32:05 <Chilli> eg,
18:32:16 <Chilli> case ^ (Data.Complex.$w:+
18:32:16 <Chilli> 												      @ Mandelbrot.T
18:32:16 <Chilli> 												      x5
18:32:16 <Chilli> 												      ds16)
18:32:16 <Chilli> 												   lvl3
18:32:17 <Chilli> 											    of tpl19 { Data.Complex.:+ a35 a36 ->
18:32:34 <Chilli> why construct a :+ cell, which is immediately decomposed
18:32:52 <Chilli> doesn't make much sense and is dead slow
18:33:15 <Chilli> somehow Data.Complex.$w:+ is messing things up
18:33:36 <Chilli> $w are worker/wrappers workers
18:33:47 <Chilli> this thing should have been inlined
18:36:31 <Chilli> either there is something in the library code causing this strange code or something is funny in GHC
18:39:21 <Igloo> Seems to happen with both Complex and Complexish
18:39:34 <Igloo> What does the ^ mean?
18:40:08 <Igloo> Oh, isn't it squaring the complex number?
18:40:34 <Igloo> Yes, lvl3 = GHC.Num.$wS# 2
18:45:46 <Igloo> Hmmm, I should probably get some sleep. Thanks for your help
18:46:56 * Igloo makes a note to try passing zreal and zimag around and doing the complex stuff myself tomorrow
18:48:14 <Chilli> night
18:48:17 <Pseudonym> Night.
18:48:26 <Igloo> g'night
18:49:32 <Chilli> (yeah, inlining the squaring should help)
22:26:37 <ibid> morning :-)
22:31:12 * ibid just looked at what you people discussed shortly after i disappeared
22:31:27 <ibid> the ffi addendum is definitely not a derived work
